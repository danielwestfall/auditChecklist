<!DOCTYPE html>
<html>
  <head>
    <title>WCAG 2.2 Audit Report</title>
    <style>
      body {
        font-family: sans-serif;
      }

      .controls {
        margin-bottom: 20px;
        display: grid;
        grid-template-columns: repeat(
          7,
          1fr
        ); /* Create 3 equal-width columns */
        gap: 10px; /* Adjust gap as needed */
      }

      .tab-content {
        display: none;
        border: 1px solid #ddd;
        padding: 10px;
      }

      .tab-content.active {
        display: block;
      }

      input[type="radio"] {
        margin-right: 5px;
      }

      table {
        width: 100%;
        border-collapse: collapse;
      }

      th,
      td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;
      }

      iframe {
        width: 100%;
        height: 80vh;
        border: none;
      }

      .guideline-control {
        display: flex;
        align-items: center; /* Center vertically */
        justify-content: center; /* Center horizontally */
        margin-bottom: 10px;
        flex-direction: column;
      }

      .guideline-control label {
        margin-right: 10px;
      }

      .guideline-control > div {
        padding-top: 5px;
        padding-bottom: 5px;
      }
    </style>
  </head>
  <body>
    <h1>WCAG 2.2 Audit Report</h1>

    <div class="controls">
      <div class="guideline-control">
        <div>
          <input type="radio" id="guideline-1.1" name="guideline" checked />
          <label for="guideline-1.1">1.1 Text Alternatives</label>
        </div>
        <div>
          <input type="checkbox" id="guideline-1.1-completed" />
          <label for="guideline-1.1-completed">Completed</label>
        </div>
      </div>

      <div class="guideline-control">
        <div>
          <input type="radio" id="guideline-1.2" name="guideline" />
          <label for="guideline-1.2">1.2 Time-based Media</label>
        </div>
        <div>
          <input type="checkbox" id="guideline-1.2-completed" />
          <label for="guideline-1.2-completed">Completed</label>
        </div>
      </div>

      <div class="guideline-control">
        <div>
          <input type="radio" id="guideline-1.3" name="guideline" />
          <label for="guideline-1.3">1.3 Adaptable</label>
        </div>
        <div>
          <input type="checkbox" id="guideline-1.3-completed" />
          <label for="guideline-1.3-completed">Completed</label>
        </div>
      </div>

      <div class="guideline-control">
        <div>
          <input type="radio" id="guideline-1.4" name="guideline" />
          <label for="guideline-1.4">1.4 Distinguishable</label>
        </div>
        <div>
          <input type="checkbox" id="guideline-1.4-completed" />
          <label for="guideline-1.4-completed">Completed</label>
        </div>
      </div>

      <div class="guideline-control">
        <div>
          <input type="radio" id="guideline-2.1" name="guideline" />
          <label for="guideline-2.1">2.1 Keyboard Accessible</label>
        </div>
        <div>
          <input type="checkbox" id="guideline-2.1-completed" />
          <label for="guideline-2.1-completed">Completed</label>
        </div>
      </div>

      <div class="guideline-control">
        <div>
          <input type="radio" id="guideline-2.2" name="guideline" />
          <label for="guideline-2.2">2.2 Enough Time</label>
        </div>
        <div>
          <input type="checkbox" id="guideline-2.2-completed" />
          <label for="guideline-2.2-completed">Completed</label>
        </div>
      </div>

      <div class="guideline-control">
        <div>
          <input type="radio" id="guideline-2.3" name="guideline" />
          <label for="guideline-2.3">2.3 Seizures</label>
        </div>
        <div>
          <input type="checkbox" id="guideline-2.3-completed" />
          <label for="guideline-2.3-completed">Completed</label>
        </div>
      </div>

      <div class="guideline-control">
        <div>
          <input type="radio" id="guideline-2.4" name="guideline" />
          <label for="guideline-2.4">2.4 Navigable</label>
        </div>
        <div>
          <input type="checkbox" id="guideline-2.4-completed" />
          <label for="guideline-2.4-completed">Completed</label>
        </div>
      </div>

      <div class="guideline-control">
        <div>
          <input type="radio" id="guideline-2.5" name="guideline" />
          <label for="guideline-2.5">2.5 Input Modalities</label>
        </div>
        <div>
          <input type="checkbox" id="guideline-2.5-completed" />
          <label for="guideline-2.5-completed">Completed</label>
        </div>
      </div>

      <div class="guideline-control">
        <div>
          <input type="radio" id="guideline-3.1" name="guideline" />
          <label for="guideline-3.1">3.1 Readable</label>
        </div>
        <div>
          <input type="checkbox" id="guideline-3.1-completed" />
          <label for="guideline-3.1-completed">Completed</label>
        </div>
      </div>

      <div class="guideline-control">
        <div>
          <input type="radio" id="guideline-3.2" name="guideline" />
          <label for="guideline-3.2">3.2 Predictable</label>
        </div>
        <div>
          <input type="checkbox" id="guideline-3.2-completed" />
          <label for="guideline-3.2-completed">Completed</label>
        </div>
      </div>

      <div class="guideline-control">
        <div>
          <input type="radio" id="guideline-3.3" name="guideline" />
          <label for="guideline-3.3">3.3 Input Assistance</label>
        </div>
        <div>
          <input type="checkbox" id="guideline-3.3-completed" />
          <label for="guideline-3.3-completed">Completed</label>
        </div>
      </div>

      <div class="guideline-control">
        <div>
          <input type="radio" id="guideline-4.1" name="guideline" />
          <label for="guideline-4.1">4.1 Compatible</label>
        </div>
        <div>
          <input type="checkbox" id="guideline-4.1-completed" />
          <label for="guideline-4.1-completed">Completed</label>
        </div>
      </div>

      <button onclick="generateReport()">Generate Report</button>
    </div>

    <div id="guideline-1.1-content" class="tab-content active">
      <iframe
        id="guideline-1.1-iframe"
        src="1_1_Text_Alternatives.html"
      ></iframe>
    </div>
    <div id="guideline-1.2-content" class="tab-content">
      <iframe
        id="guideline-1.2-iframe"
        src="1_2_Time-based_Media.html"
      ></iframe>
    </div>
    <div id="guideline-1.3-content" class="tab-content">
      <iframe id="guideline-1.3-iframe" src="1_3_Adaptable.html"></iframe>
    </div>
    <div id="guideline-1.4-content" class="tab-content">
      <iframe id="guideline-1.4-iframe" src="1_4_Distinguishable.html"></iframe>
    </div>
    <div id="guideline-2.1-content" class="tab-content">
      <iframe
        id="guideline-2.1-iframe"
        src="2_1_Keyboard_Accessible.html"
      ></iframe>
    </div>
    <div id="guideline-2.2-content" class="tab-content">
      <iframe id="guideline-2.2-iframe" src="2_2_Enough_Time.html"></iframe>
    </div>
    <div id="guideline-2.3-content" class="tab-content">
      <iframe id="guideline-2.3-iframe" src="2_3_Seizures.html"></iframe>
    </div>
    <div id="guideline-2.4-content" class="tab-content">
      <iframe id="guideline-2.4-iframe" src="2_4_Navigable.html"></iframe>
    </div>
    <div id="guideline-2.5-content" class="tab-content">
      <iframe
        id="guideline-2.5-iframe"
        src="2_5_Input_Modalities.html"
      ></iframe>
    </div>
    <div id="guideline-3.1-content" class="tab-content">
      <iframe id="guideline-3.1-iframe" src="3_1_Readable.html"></iframe>
    </div>
    <div id="guideline-3.2-content" class="tab-content">
      <iframe id="guideline-3.2-iframe" src="3_2_Predictable.html"></iframe>
    </div>
    <div id="guideline-3.3-content" class="tab-content">
      <iframe
        id="guideline-3.3-iframe"
        src="3_3_Input_Assistance.html"
      ></iframe>
    </div>
    <div id="guideline-4.1-content" class="tab-content">
      <iframe id="guideline-4.1-iframe" src="4_1_Compatible.html"></iframe>
    </div>

    <table id="report-table"></table>

    <button onclick="downloadTable()">Download Table</button>

    <script>
      // Function to show the selected tab
      function showTab(tabId) {
        const tabContents = document.querySelectorAll(".tab-content");
        tabContents.forEach((tab) => tab.classList.remove("active"));
        document.getElementById(tabId + "-content").classList.add("active");
      }

      // Event listeners for radio button changes
      const radioButtons = document.querySelectorAll('input[name="guideline"]');
      radioButtons.forEach((radio) => {
        radio.addEventListener("change", () => {
          showTab(radio.id);
        });
      });

      function generateReport() {
        const table = document.getElementById("report-table");
        table.innerHTML = ""; // Clear previous table data

        // Add table header
        const headerRow = table.insertRow();
        headerRow.insertCell().textContent = "Guideline";
        headerRow.insertCell().textContent = "Success Criterion";
        headerRow.insertCell().textContent = "Notes";
        headerRow.insertCell().textContent = "Completed";
        headerRow.insertCell().textContent = "Applicable";

        // Function to process each guideline
        function processGuideline(guidelineId, guidelineName) {
          const iframe = document.getElementById(guidelineId + "-iframe");
          const completed = document.getElementById(
            guidelineId + "-completed"
          ).checked;
          const checklistData = JSON.parse(
            iframe.contentWindow.getChecklistData()
          );

          for (const sc in checklistData) {
            const row = table.insertRow();
            row.insertCell().textContent = guidelineName;
            row.insertCell().textContent = sc;
            row.insertCell().textContent = checklistData[sc].notes; // Access notes from the object
            row.insertCell().textContent = completed ? "Yes" : "No";
            row.insertCell().textContent = checklistData[sc].applicable
              ? "Yes"
              : "N/A"; // Add "Applicable" status
          }
        }

        // Process each guideline
        processGuideline("guideline-1.1", "1.1 Text Alternatives");
        processGuideline("guideline-1.2", "1.2 Time-based Media");
        processGuideline("guideline-1.3", "1.3 Adaptable");
        processGuideline("guideline-1.4", "1.4 Distinguishable");
        processGuideline("guideline-2.1", "2.1 Keyboard Accessible");
        processGuideline("guideline-2.2", "2.2 Enough Time");
        processGuideline("guideline-2.3", "2.3 Seizures");
        processGuideline("guideline-2.4", "2.4 Navigable");
        processGuideline("guideline-2.5", "2.5 Input Modalities");
        processGuideline("guideline-3.1", "3.1 Readable");
        processGuideline("guideline-3.2", "3.2 Predictable");
        processGuideline("guideline-3.3", "3.3 Input Assistance");
        processGuideline("guideline-4.1", "4.1 Compatible");
      }

      function downloadTable() {
        const table = document.getElementById("report-table");
        let csvContent = "data:text/csv;charset=utf-8,"; // Semicolon was here

        // Loop through table rows
        const rows = table.querySelectorAll("tr");
        rows.forEach(function (row) {
          const rowData = [];
          const cells = row.querySelectorAll("th, td");

          // Loop through row cells
          cells.forEach(function (cell) {
            let cellData = cell.textContent.replace(/,/g, ""); // Remove commas from cell content
            cellData = '"' + cellData + '"'; // Quote cell data
            rowData.push(cellData);
          });

          csvContent += rowData.join(",") + "\r\n"; // Add row data to CSV
        });

        // Create download link
        const encodedUri = encodeURI(csvContent);
        const link = document.createElement("a");
        link.setAttribute("href", encodedUri);
        link.setAttribute("download", "wcag_audit_report.csv");
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
      }
    </script>
  </body>
</html>
